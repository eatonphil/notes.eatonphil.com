# HTTP Basics (1): protocol and programming
## April 6, 2019

Say we have an <code>hello-world.html</code> file:

```html
<html>
  <body>
    <h1>Hello world!</h1>
  </body>
</html>
```

And say we'd like to be able to render this page in a web browser. If
the server is hosted locally we may want to enter
<code>localhost:9000/hello-world.html</code> in the address bar, hit
enter, make a request (done by the browser), receive a response (sent
by some server), and render the result (done by the browser).

What is needed for a server to handle this interaction correctly?

### The protocol

HTTP (version 1.1, specifically) is a convention for connecting over
TCP/IP and sending plain-text messages between two processes. HTTP
messages are broken into two categories: requests (the sender of a
request is called a "client") and responses (the sender of a response
is called a "server").

HTTP is important because it is the default protocol of web
browsers. When we type in <code>localhost:9000/hello-world.html</code>
and hit enter, the browser will open an HTTP connection to the
location <code>localhost</code> on the port <code>9000</code> and send
an HTTP request. If/when it receives the HTTP response from the server
it will try to render the response.

#### An HTTP request

A bare minimum HTTP/1.1 request ([defined in an
RFC](https://www.w3.org/Protocols/rfc2616/rfc2616-sec5.html)) based on
the request for <code>localhost:9000/hello-world.html</code> is the
following:

```http
GET /hello-world.html HTTP/1.1\r\nHost: localhost:9000\r\n\r\n
```

NOTE: the spec explicitly requires the <code>\r\n</code> combo to
represent a newline instead of simply <code>\n</code>.

If we printed out this request it would look like this:

```http
GET /hello-world.html HTTP/1.1
Host: localhost:9000

```

#### Components of an HTTP request

An HTTP/1.1 request is made up of a few parts:

* [Mandatory]: The status line (the first line) followed by a CRLF (the <code>\r\n</code> combo)
* [Mandatory]: HTTP headers separated by a CRLF and followed by an additional CRLF
* [Optional]: The request body

The status line consists of the request method (e.g. GET, POST, PUT,
etc.), the path for the request, and the protocol -- all separated by
a space.

An HTTP header is a key-value pair separated by a colon. Spaces
following the colon are ignored. The key is case insensitive. Only
the <code>Host</code> header appears to be mandatory. Since these
headers are sent by the client they are intended for the server's use.

The request body is text and is only relevant for requests of certain
methods (e.g. POST but not GET).

#### An HTTP response

A bare minimum HTTP/1.1 response ([defined in another
RFC](https://www.w3.org/Protocols/rfc2616/rfc2616-sec6.html)) based on
the file we wanted to send back is the following:

```http
HTTP/1.1 200 OK\r\n\r\n<html>\n  <body>\n    <h1>Hello world!</h1>\n  </body>\n</html>
```

If we printed out this response it would look like this:

```http
HTTP/1.1 200 OK

<html>
  <body>
    <h1>Hello world!</h1>
  </body>
</html>
```

#### Components of an HTTP response

An HTTP/1.1 response is made up of a few parts:

* [Mandatory]: The status line (the first line) followed by a CRLF
* [Optional]: HTTP headers separated by a CRLF and followed by an additional CRLF
* [Optional]: The request body

The status line consists of the protocol, the status code, and the
status message -- all separated by a space.

HTTP response headers are the same as HTTP request headers although in
a response they are directives from the server to the client. There
are many [standard
headers](https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html) that
are used for such things as setting cache rules, setting cookies,
settings response type (e.g. HTML vs CSS vs PNG so the browser knows
how to handle the response).

The response body is similar to the HTTP request body.

### Programming

Most operating systems have a built-in means of connecting over TCP/IP
(and sending and receiving messages) called "sockets". Most
programming languages have a built-in socket library.


